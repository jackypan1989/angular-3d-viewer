/**
 * Angular 3d Viewer
 * @version v0.0.1 - 2014-04-14
 * @link http://jackypan1989.github.com/angular-3d-viewer
 * @author Guan Yu Pan
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angular-3d-viewer",[]),angular.module("angular-3d-viewer").directive("hello",function(){return{restrict:"E",replace:!0,template:'<canvas id="mainCanvas"></canvas>',link:function(a){function b(){d=new THREE.WebGLRenderer({canvas:document.getElementById("mainCanvas")}),d.setSize(j,k),d.setClearColor(15658734),e=new THREE.Scene,f=new THREE.PerspectiveCamera(75,j/k,1,1e4),f.position.set(0,0,70),e.add(f);var a=new THREE.DirectionalLight(16777215);a.position.x=0,a.position.y=0,a.position.z=1,a.position.normalize(),e.add(a);var b=(new THREE.MeshPhongMaterial({ambient:5592405,color:11184810,specular:1118481,shininess:200}),new THREE.STLLoader);b.addEventListener("load",function(a){var b=a.content;b.computeFaceNormals(),g[h]=new THREE.Mesh(b,new THREE.MeshNormalMaterial({overdraw:!0})),g[h].position=new THREE.Vector3(0,-30,0),e.add(g[h]),h++,h>=2&&c();for(var d=0;d<g.length;d++)g[d].visible=!1;g[0].visible=!0}),async.series([function(a){b.load("./models/Subsetup2_Mandibular.stl"),a(null,"two")},function(a){b.load("./models/Subsetup1_Mandibular.stl"),a(null,"three")},function(a){b.load("./models/Mandibular.stl"),a(null,"one")}],function(){})}function c(){if(l)for(var a=0;a<g.length;a++)g[a].rotation.y+=.01;d.render(e,f),requestAnimationFrame(c)}var d,e,f,g=[],h=0,i=0,j=800,k=600,l=!1;b(),a.viewFromTop=function(){f.position.set(0,50,0);var a=new THREE.Vector3(0,0,0);f.lookAt(a)},a.viewFromBottom=function(){f.position.set(0,-100,0);var a=new THREE.Vector3(0,0,0);f.lookAt(a)},a.viewFromSide=function(){f.position.set(0,0,70);var a=new THREE.Vector3(0,0,0);f.lookAt(a)},a.nextStep=function(){i++,i>g.length-1&&(i=0);for(var a=0;a<g.length;a++)g[a].visible=!1;g[i].visible=!0},a.play=function(){l=!0},a.stop=function(){l=!1}}}});